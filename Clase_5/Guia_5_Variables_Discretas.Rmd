---
title: "Guía de trabajo variables discretas"
subtitle: 'Diplomado en Análisis de datos con R para la acuicultura'
author:
 name: Dr. José A. Gallardo y Dra. María Angélica Rueda.
 affiliation: Pontificia Universidad Católica de Valparaíso
 email: <jose.gallardo@pucv.cl>
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    code_folding: hide
  word_document: default
  pdf_document: default
---

<style>
#TOC {
  color: black;
  font-familiy: Calibri;
  font-size: 14px;
  border-color: #708090; 
}
body {
   color: black;
   font-familiy: Calibri;
}

pre {
  color: black;
  background-color: #F8F8FF;
}
# header {
  color: #800000;
  font-familiy: Calibri;
  background-color: #F5F5F5;
  opacity: 0.8;
  font-size: 16px;
}
</style>


```{r setup, include=TRUE, warning=FALSE,message=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Librería stats está instalada por defecto en la base de R
library(stats)

# Librería pander permite crear tablas con leyendas en Rmarkdown
library(pander)

# Librería MASS contiene funciones de apoyo para trabajar con el libro de Venables and Ripley llamado Modern Applied Statistics with S (2002) 
library(MASS)

# Librería Rlab permite cargar las funciones para la distribución Bernoulli.
library(Rlab)

```
#### **Introducción**


#### **Clasificación de variables**

**Variables discretas:** Una variable **Y** es **_discreta_** si puede tomar valores puntales (enteros positivos incluyendo el cero), puede tener un número finito o infinito de valores. Todas las probabilidades asociadas a cada valor de la variable aleatoria discreta deberán sumar 1. La función de distribución de probabilidad acumulada es, la probabilidad de que la variable aleatoria sea menor o igual a un valor particular. 

**Tipos de distribución de variables discretas**

Hay diferentes tipos de distribuciones acordes a variables cuantitativas discretas, en este caso solo veremos dos, estás son: la distribucción **_Bernoulli_** **(Be)** y la **_distribución Binomial_** **(B)**.

**_Ejemplo:_** Número de peces evaluados en el estudio a los que no les hace efecto la vacuna (muere el paciente), si es macho o hembra, si un pez está vivo o muerto. 

#### **Distribución de una variable discreta**

**_Distribución empírica (observación)_**: Los datos de una muestra, obtenidos de forma aleatoria de una población, pueden ser usados para observar su distribución. 

**_Distribución de probabilidad (predicción)_**: Las variables aleatorias tienen diferente distribución de probabilidad asociada, es decir, ésta dependerá de la naturaleza de la variable aleatoria en estudio. Considerando esto, es posible predecir su comportamiento y realizar inferencias estadísticas.

#### **Objetivos de aprendizaje**

Los objetivos de aprendizaje de esta guía son:

**1**. Observar y predecir el comportamiento de variables aleatorias discretas con distribución Bernoulli.

**2**. Observar y predecir el comportamiento de variables aleatorias discretas con distribución de Binomial.

**3**. Elaborar un reporte html con **[Rmarkdown](https://rmarkdown.rstudio.com/)**.


#### **Comandos**

A continuación, se presentan algunos comandos que podrían ser usados para resolver los ejercicios de esta guía. Otros, los usará más adelante en el curso y los deberá investigar por su propia cuenta. 

**_¿Cómo puedo observar el comportamiento de una variable discreta?_**

**1.-** Tabla de distribución de frecuencia **table()**.

**2.-** Gráfico de barras **barplot()**.

**3.-** Histograma **hist()**.

**_¿Cómo puedo predecir el comportamiento de una variable con distribución Bernoulli?_**

**4.-** Mediante la **_función de distribución de probabilidad acumulada_** **pbern()**.

**5.-** Mediante **_la función de densidad de probabilidad Bernoulli_** **dbern()**.

**6.-** Mediante la función para encontrar los **_cuantiles_** **qbern()**.

**_¿Cómo simular/generar una variable aleatoria Bernoulli?_**
**rbern()**

**_¿Cómo puedo predecir el comportamiento de una variable con distribución Binomial?_**

**7.-** Mediante la **_función de distribución de probabilidad acumulada_** **pbinom()**.

**8.-** Mediante la **_función de densidad de probabilidad Binomial_** **dbinom()**.

**9.-** Mediante la función para encontrar los **_cuantiles_** **qbinom()**.

**_¿Cómo simular/generar una variable aleatoria Binomial?_**
**rbinom()**

### **Ejercicios**

#### **Ejercicios de variable aleatoria discreta con distribucción Bernoulli.**

### **Ejercicio 1.**
Para la exportación de salmón en Chile se seleccionan los mejores ejemplares, de manera aleatoria, 3 de ellos. Se hace una inspección de los salmones y se clasifican en defectuosos **(D)** y no defectuosos **(ND)**. En el proceso de selección se detecta en total el 25% de salmones defectuosos. Se considera un éxito la obtención de un salmón defectuoso.

**a.** ¿Que tipo de variable y distribución mejor representa el número de éxitos, es decir, la obtención de un salmón defectuoso?

```{r}
"Variable Discreta"
"Distribución Bernoulli"
```
**b.** ¿Cuál es la probabilidad de éxito (p)?  

```{r}
p <- 25 / 100
```
**c.** ¿Cuál es la probabilidad de fracaso (q)?
```{r}
q <- 1-p
```
### **Ejercicio 2.**

**d** Responda las siguientes preguntas usando la información de la siguiente tabla relacionada al ejercicio 1:

<div class="centered">
![](~/GitHub/DiplomadoR_Acuicultura_v21/Imagenes/Clase5/Eje1.png)
</div>

**d.** ¿Cuál es la probabilidad cuando no se tienen salmones defectuosos?

```{r}
# P(Y=0)  
P_ND <- q*q*q
```
**e.** ¿Cuál es la probabilidad cuando se tienen los salmones defectuoso?

```{r}
# P(Y=3)  
P_PD <- p*p*p
```
#### **Ejercicios de variable aleatoria discreta con distribucción Binomial.**

### **Ejercicio 3.**

La tasa de mortalidad por enganche del pez lucio del Norte de Manitoba es de alrededor del 5%. Supongamos que el pescador atrapó y liberó 16 lucios del Norte en Manitoba. ¿Cuál es la probabilidad de que? 

**_Nota:_** Usar set.seed(123) antes de pedir cada las siguientes probabilidades.

**a.** ¿Cuál es la probabilidad de éxito (p)?  

```{r}
p<- 5 / 100
```

**b.** ¿Que tipo de variable y distribución mejor representa a la tasa de mortalidad por enganche del pez lucio?

```{r}
"Variable Discreta"
"Distribución Binomial"
```
**c.** Ninguno de los peces murió.
```{r}
set.seed(123)
# n = 16 peces
# p = 0.05 (Probabilidad de éxito)
# q = 1-p (Probabilidad de fracaso)
# P(X=0) (Ninguno de los peces murió)
Ningun_pez_muerto <- dbinom(0,16,0.05);Ningun_pez_muerto
```

**d.** Menos de 3 peces murieron.
```{r}
set.seed(123)
# n = 16 peces
# p = 0.05 (Probabilidad de éxito)
# q = 1-p (Probabilidad de fracaso)
# P(X<3) = P(X=0)+P(X=1)+P(X=2) (Menos de 3 peces murieron)

Menos3_peces_murieron <- sum(dbinom(0:2,16,0.05));Menos3_peces_murieron
```
**e.** Al menos uno de los peces murió
```{r}
set.seed(123)
# n = 16 peces
# p = 0.05 (Probabilidad de éxito)
# q = 1-p (Probabilidad de fracaso)
# P(X>=1) = 1- P(X=0); (Al menos uno de los peces murió)
Almenos_1peces_murio <- 1-Ningun_pez_muerto;Almenos_1peces_murio
```

**f.** A lo sumo dos peces murieron.
```{r}
set.seed(123)
# n = 16 peces
# p = 0.05 (Probabilidad de éxito)
# q = 1-p (Probabilidad de fracaso)
# P(X<=2) = P(X=0)+P(X=1)+P(X=2); (A lo sumo dos peces murieron)
Alosumo_2peces_murieron <- sum(dbinom(0:2,16,0.05));Alosumo_2peces_murieron
```

**Ejercicio 4.**

*Alexandrium catenella* es una microalga tóxica que produce el veneno paralizante de los mariscos (VPM). En Chile las intoxicaciones por VPM entre 1972-2002 generaron 456 enfermos y 30 fallecidos (total = 486). A partir de estos antecedentes responda.

**a.** ¿Cuál es la letalidad por VPM en Chile?

```{r}
30 / 486
```

**b.** ¿Que tipo de variable y distribución mejor representa a la intoxicación por VPM?

```{r}
"Variable Discreta"
"Distribución Bernoulli"
```

**c.** Se ha reportado un intoxicación masiva en la caleta Portales de Valparaíso que dió como resultado 80 personas intoxicadas. ¿Cuántas personas se recuperarán (0) y cuantas morirán (1) por esta intoxicación?. 

Para responder primero cree un objeto denominado **rvpm* y simule el resultado de la intoxicación usando rbinom(). Recuerde usar set.seed(123) y la tasa de letalidad calculada anteriormente. Use print() para observar sus datos simulados.

Simulación de población intoxicada. 
```{r}
set.seed(123)
n <- 80
p <- 0.0617
q <- 1-p
rvpm<-rbinom(n, size=1, prob=0.0617)
print(rvpm)
```

Tabla con frecuencia de recuperados y fallecidos
```{r}
table(rvpm)

#Tabla con formato para reporte

knitr::kable(
  table(rvpm),
  row.names = TRUE
  , caption = "Recuperados (0) versus fallecidos (1)")
```

Histograma con frecuencia de recuperados y fallecidos
```{r, out.width = '80%'}
hist(rvpm, col="red", main = "Histograma Intoxicación por VPM")
```

**d.** Investigue como se calcula el promedio y la varianza de una variable con distribución binomial. Calcule ambos parámetros para la población de estudio.

Promedio de fallecidos
```{r}
n*p
```

Varianza de fallecidos
```{r}
n*p*q
```

**e.** Gráfique la función de densidad de las intoxicaciones por VPM usando la función plot. En el eje "x" grafique los datos simulados con rbinom() y en el eje "y" la función de densidad dbinom().

```{r, out.width = '80%'}
dvpm<-dbinom(rvpm, size=1, prob=0.0617)
plot(x=rvpm, y=dvpm, main="Densidad de rvpm", col="blue4")

```
**f.** Gráfique la  distribución de probabilidad acumulada de las intoxicaciones por VPM usando la función plot(). En el eje **"x"** grafique los datos simulados con **_rbinom()_** y en el eje **"y"** la probabilidad acumulada con **_pbinom()_**.

```{r, out.width = '80%'}
pvpm<-pbinom(rvpm, size=1, prob=0.0617)
plot(x=rvpm, y=pvpm, main="Prob. acumul. rvpm", col="red", ylim=c(0,1))
```

**g.** Use la función qqnorm para chequear la normalidad de los datos. Interprete su resultado.

```{r, out.width = '80%'}
qqnorm(rvpm, col="coral")
```
